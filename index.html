<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SWPPP Management Hub</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Lucide React icons as simple SVG components
        const MapPin = () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" /></svg>;
        const Search = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" /></svg>;
        const Filter = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.707A1 1 0 013 7V4z" /></svg>;
        const User = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" /></svg>;
        const FileText = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" /></svg>;
        const Download = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" /></svg>;
        const Plus = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 6v6m0 0v6m0-6h6m-6 0H6" /></svg>;
        const Eye = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" /></svg>;
        const Edit3 = () => <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" /></svg>;
        const CheckCircle = () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const Clock = () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;
        const AlertTriangle = () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4.5c-.77-.833-2.694-.833-3.464 0L3.34 16.5c-.77.833.192 2.5 1.732 2.5z" /></svg>;
        const XCircle = () => <svg className="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>;

        const SWPPPInspectionHub = () => {
          // Shawn Garland's actual inspection data
          const [inspections, setInspections] = useState([
            {
              id: 1,
              siteName: "St. Francios Substation",
              address: "3980 Hazel run Road, Bonne Terre",
              lat: 37.9222,
              lng: -90.5548,
              inspector: "Shawn Garland",
              inspectionDate: "2024-01-15",
              status: "completed",
              findings: "Routine inspection completed",
              nextInspection: "2024-02-15",
              permitNumber: "SWP-2024-001",
              contractor: "Ameren",
              phase: "Operations",
              contractId: "CONTRACT-AMEREN-2024",
              dayDue: "Monday"
            },
            {
              id: 2,
              siteName: "Hampton Inn",
              address: "1331 Shapiro Drive, Festus",
              lat: 38.2156,
              lng: -90.4040,
              inspector: "Shawn Garland",
              inspectionDate: "2024-01-15",
              status: "completed",
              findings: "All SWPPP measures in place",
              nextInspection: "2024-02-15",
              permitNumber: "SWP-2024-002",
              contractor: "Budrovich",
              phase: "Construction",
              contractId: "CONTRACT-BUDROVICH-2024",
              dayDue: "Monday"
            },
            {
              id: 3,
              siteName: "Mercy Hospital South",
              address: "10010 Kennerly Road, St. Louis, MO 63128",
              lat: 38.5156,
              lng: -90.3645,
              inspector: "Shawn Garland",
              inspectionDate: "2024-01-17",
              status: "completed",
              findings: "Excellent SWPPP compliance",
              nextInspection: "2024-02-17",
              permitNumber: "SWP-2024-008",
              contractor: "Budrovich",
              phase: "Construction",
              contractId: "CONTRACT-BUDROVICH-2024",
              dayDue: "Wednesday"
            },
            {
              id: 4,
              siteName: "St. Louis Zoo Main Zoo",
              address: "1 Government Dr, St. Louis, MO 63110 - GATE 5",
              lat: 38.6356,
              lng: -90.2944,
              inspector: "Shawn Garland",
              inspectionDate: "2024-01-17",
              status: "completed",
              findings: "Zoo facility inspection - special protocols",
              nextInspection: "2024-02-17",
              permitNumber: "SWP-2024-012",
              contractor: "Budrovich",
              phase: "Construction",
              contractId: "CONTRACT-BUDROVICH-2024",
              dayDue: "Wednesday"
            },
            {
              id: 5,
              siteName: "7 Brew",
              address: "1289 Jeffco Blvd, Arnold",
              lat: 38.4245,
              lng: -90.3773,
              inspector: "Shawn Garland",
              inspectionDate: "2024-01-28",
              status: "pending",
              findings: "New project starting July 28",
              nextInspection: "2024-02-28",
              permitNumber: "SWP-2024-005",
              contractor: "7 brew",
              phase: "Pre-construction",
              contractId: "CONTRACT-7BREW-2024",
              dayDue: "TBD"
            }
          ]);

          // Contract data based on Shawn's customer list
          const [contracts, setContracts] = useState([
            {
              id: "CONTRACT-AMEREN-2024",
              contractor: "Ameren",
              startDate: "2024-01-01",
              expirationDate: "2024-12-31",
              monthlyQuota: 4,
              totalQuota: 48,
              contractValue: 24000,
              status: "active"
            },
            {
              id: "CONTRACT-BUDROVICH-2024",
              contractor: "Budrovich",
              startDate: "2024-01-01",
              expirationDate: "2024-12-31",
              monthlyQuota: 12,
              totalQuota: 144,
              contractValue: 72000,
              status: "active"
            },
            {
              id: "CONTRACT-7BREW-2024",
              contractor: "7 brew",
              startDate: "2024-07-28",
              expirationDate: "2025-01-31",
              monthlyQuota: 4,
              totalQuota: 24,
              contractValue: 12000,
              status: "active"
            }
          ]);

          const [selectedInspector, setSelectedInspector] = useState('all');
          const [selectedStatus, setSelectedStatus] = useState('all');
          const [selectedContract, setSelectedContract] = useState('all');
          const [searchTerm, setSearchTerm] = useState('');
          const [selectedInspection, setSelectedInspection] = useState(null);
          const [activeTab, setActiveTab] = useState('inspections');
          const [mapLoaded, setMapLoaded] = useState(false);

          // Get unique inspectors
          const inspectors = useMemo(() => {
            const uniqueInspectors = [...new Set(inspections.map(i => i.inspector))];
            return uniqueInspectors.sort();
          }, [inspections]);

          // Calculate monthly performance for each contract
          const contractPerformance = useMemo(() => {
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();
            
            return contracts.map(contract => {
              const contractInspections = inspections.filter(i => i.contractId === contract.id);
              
              const thisMonthCompleted = contractInspections.filter(i => {
                const inspectionDate = new Date(i.inspectionDate);
                return inspectionDate.getMonth() === currentMonth && 
                       inspectionDate.getFullYear() === currentYear &&
                       i.status === 'completed';
              }).length;

              const totalCompleted = contractInspections.filter(i => i.status === 'completed').length;
              
              const daysUntilExpiration = Math.ceil(
                (new Date(contract.expirationDate) - new Date()) / (1000 * 60 * 60 * 24)
              );

              let contractStatus = contract.status;
              if (daysUntilExpiration <= 30 && daysUntilExpiration > 0) {
                contractStatus = 'expiring_soon';
              } else if (daysUntilExpiration <= 0) {
                contractStatus = 'expired';
              }

              return {
                ...contract,
                thisMonthCompleted,
                totalCompleted,
                daysUntilExpiration,
                contractStatus,
                monthlyProgress: (thisMonthCompleted / contract.monthlyQuota) * 100,
                totalProgress: (totalCompleted / contract.totalQuota) * 100
              };
            });
          }, [contracts, inspections]);

          // Filter inspections
          const filteredInspections = useMemo(() => {
            return inspections.filter(inspection => {
              const matchesInspector = selectedInspector === 'all' || inspection.inspector === selectedInspector;
              const matchesStatus = selectedStatus === 'all' || inspection.status === selectedStatus;
              const matchesContract = selectedContract === 'all' || inspection.contractId === selectedContract;
              const matchesSearch = searchTerm === '' || 
                inspection.siteName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                inspection.contractor.toLowerCase().includes(searchTerm.toLowerCase()) ||
                inspection.permitNumber.toLowerCase().includes(searchTerm.toLowerCase());
              
              return matchesInspector && matchesStatus && matchesContract && matchesSearch;
            });
          }, [inspections, selectedInspector, selectedStatus, selectedContract, searchTerm]);

          // Status configuration
          const getStatusConfig = (status) => {
            switch (status) {
              case 'completed':
                return { color: 'text-green-600 bg-green-50', icon: CheckCircle, label: 'Completed' };
              case 'pending':
                return { color: 'text-yellow-600 bg-yellow-50', icon: Clock, label: 'Pending' };
              case 'violation':
                return { color: 'text-red-600 bg-red-50', icon: AlertTriangle, label: 'Violation' };
              default:
                return { color: 'text-gray-600 bg-gray-50', icon: Clock, label: 'Unknown' };
            }
          };

          const getContractStatusConfig = (status) => {
            switch (status) {
              case 'active':
                return { color: 'text-green-600 bg-green-50 border-green-200', label: 'Active' };
              case 'expiring_soon':
                return { color: 'text-yellow-600 bg-yellow-50 border-yellow-200', label: 'Expiring Soon' };
              case 'expired':
                return { color: 'text-red-600 bg-red-50 border-red-200', label: 'Expired' };
              default:
                return { color: 'text-gray-600 bg-gray-50 border-gray-200', label: 'Unknown' };
            }
          };

          // Real Leaflet Map Component
          const MapComponent = () => {
            useEffect(() => {
              if (window.L && document.getElementById('swppp-map')) {
                // Remove existing map if it exists
                const mapContainer = document.getElementById('swppp-map');
                mapContainer.innerHTML = '';

                // Create the map
                const map = window.L.map('swppp-map').setView([38.6270, -90.3073], 10);

                // Add OpenStreetMap tiles
                window.L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
                  attribution: '© OpenStreetMap contributors'
                }).addTo(map);

                // Add markers for filtered inspections
                filteredInspections.forEach(inspection => {
                  const markerColor = 
                    inspection.status === 'completed' ? 'green' :
                    inspection.status === 'pending' ? 'orange' :
                    inspection.status === 'violation' ? 'red' : 'gray';

                  // Create a simple circular marker
                  const marker = window.L.circleMarker([inspection.lat, inspection.lng], {
                    color: 'white',
                    weight: 2,
                    fillColor: markerColor,
                    fillOpacity: 0.8,
                    radius: 8
                  }).addTo(map);

                  // Add popup with inspection details
                  marker.bindPopup(`
                    <div style="min-width: 200px;">
                      <h3 style="margin: 0 0 8px 0; font-size: 14px; font-weight: bold;">
                        ${inspection.siteName}
                      </h3>
                      <p style="margin: 2px 0; font-size: 12px;">
                        <strong>Address:</strong> ${inspection.address}
                      </p>
                      <p style="margin: 2px 0; font-size: 12px;">
                        <strong>Inspector:</strong> ${inspection.inspector}
                      </p>
                      <p style="margin: 2px 0; font-size: 12px;">
                        <strong>Customer:</strong> ${inspection.contractor}
                      </p>
                      <p style="margin: 2px 0; font-size: 12px;">
                        <strong>Status:</strong> ${inspection.status}
                      </p>
                    </div>
                  `);

                  // Click handler to select inspection
                  marker.on('click', () => {
                    setSelectedInspection(inspection);
                  });
                });

                // Fit map to show all markers if there are any
                if (filteredInspections.length > 0) {
                  const group = new window.L.featureGroup(
                    filteredInspections.map(inspection => 
                      window.L.marker([inspection.lat, inspection.lng])
                    )
                  );
                  map.fitBounds(group.getBounds().pad(0.1));
                }

                return () => {
                  map.remove();
                };
              }
            }, [filteredInspections]);

            return (
              <div className="relative w-full h-96 bg-gray-100 rounded-lg overflow-hidden border">
                <div id="swppp-map" className="w-full h-full"></div>
                
                {/* Map Legend */}
                <div className="absolute bottom-4 left-4 bg-white p-3 rounded-lg shadow-lg border text-xs">
                  <div className="font-semibold mb-2">Status Legend</div>
                  <div className="space-y-1">
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 rounded-full bg-green-500"></div>
                      <span>Completed</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 rounded-full bg-orange-500"></div>
                      <span>Pending</span>
                    </div>
                    <div className="flex items-center gap-2">
                      <div className="w-3 h-3 rounded-full bg-red-500"></div>
                      <span>Violation</span>
                    </div>
                  </div>
                  <div className="mt-2 pt-2 border-t text-gray-600">
                    Showing {filteredInspections.length} sites
                  </div>
                </div>
              </div>
            );
          };

          return (
            <div className="min-h-screen bg-gray-50">
              {/* Header */}
              <div className="bg-white shadow-sm border-b">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
                  <div className="flex justify-between items-center">
                    <div>
                      <h1 className="text-2xl font-bold text-gray-900">SWPPP Management Hub</h1>
                      <p className="text-gray-600">Storm Water Pollution Prevention Plan Management</p>
                    </div>
                    <div className="flex gap-2">
                      <button className="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors">
                        <Plus />
                        Add Inspection
                      </button>
                      <button className="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">
                        <Download />
                        Export Data
                      </button>
                    </div>
                  </div>
                  
                  {/* Tab Navigation */}
                  <div className="flex space-x-1 mt-4">
                    <button
                      onClick={() => setActiveTab('inspections')}
                      className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                        activeTab === 'inspections'
                          ? 'bg-blue-100 text-blue-700 border border-blue-200'
                          : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'
                      }`}
                    >
                      Inspections
                    </button>
                    <button
                      onClick={() => setActiveTab('contracts')}
                      className={`px-4 py-2 rounded-lg font-medium transition-colors ${
                        activeTab === 'contracts'
                          ? 'bg-blue-100 text-blue-700 border border-blue-200'
                          : 'text-gray-600 hover:text-gray-900 hover:bg-gray-100'
                      }`}
                    >
                      Contract Management
                    </button>
                  </div>
                </div>
              </div>

              <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
                {activeTab === 'inspections' ? (
                  <>
                    {/* Filters */}
                    <div className="bg-white rounded-lg shadow-sm border p-4 mb-6">
                      <div className="flex flex-wrap gap-4 items-center">
                        <div className="flex items-center gap-2">
                          <Search />
                          <input
                            type="text"
                            placeholder="Search sites, contractors, permits..."
                            value={searchTerm}
                            onChange={(e) => setSearchTerm(e.target.value)}
                            className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64"
                          />
                        </div>
                        
                        <div className="flex items-center gap-2">
                          <User />
                          <select
                            value={selectedInspector}
                            onChange={(e) => setSelectedInspector(e.target.value)}
                            className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          >
                            <option value="all">All Inspectors</option>
                            {inspectors.map(inspector => (
                              <option key={inspector} value={inspector}>{inspector}</option>
                            ))}
                          </select>
                        </div>

                        <div className="flex items-center gap-2">
                          <Filter />
                          <select
                            value={selectedStatus}
                            onChange={(e) => setSelectedStatus(e.target.value)}
                            className="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                          >
                            <option value="all">All Status</option>
                            <option value="completed">Completed</option>
                            <option value="pending">Pending</option>
                            <option value="violation">Violation</option>
                          </select>
                        </div>

                        <div className="ml-auto text-sm text-gray-600">
                          Showing {filteredInspections.length} of {inspections.length} inspections
                        </div>
                      </div>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                      {/* Map */}
                      <div className="lg:col-span-2">
                        <div className="bg-white rounded-lg shadow-sm border p-4">
                          <h2 className="text-lg font-semibold mb-4 flex items-center gap-2">
                            <MapPin />
                            Site Locations
                          </h2>
                          <MapComponent />
                        </div>
                      </div>

                      {/* Inspector Summary */}
                      <div className="bg-white rounded-lg shadow-sm border p-4">
                        <h2 className="text-lg font-semibold mb-4">Inspector Summary</h2>
                        <div className="space-y-3">
                          {inspectors.map(inspector => {
                            const inspectorInspections = filteredInspections.filter(i => i.inspector === inspector);
                            const completedCount = inspectorInspections.filter(i => i.status === 'completed').length;
                            const pendingCount = inspectorInspections.filter(i => i.status === 'pending').length;
                            
                            return (
                              <div
                                key={inspector}
                                className="p-3 rounded-lg bg-gray-50 hover:bg-gray-100 cursor-pointer transition-colors"
                              >
                                <div className="font-medium">{inspector}</div>
                                <div className="text-sm text-gray-600">
                                  {inspectorInspections.length} total inspections
                                </div>
                                <div className="flex gap-3 mt-2 text-xs">
                                  <span className="text-green-600">{completedCount} completed</span>
                                  <span className="text-yellow-600">{pendingCount} pending</span>
                                </div>
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    </div>

                    {/* Inspections Table */}
                    <div className="mt-6 bg-white rounded-lg shadow-sm border">
                      <div className="p-4 border-b">
                        <h2 className="text-lg font-semibold">Inspection Records</h2>
                      </div>
                      <div className="overflow-x-auto">
                        <table className="w-full">
                          <thead className="bg-gray-50">
                            <tr>
                              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Site</th>
                              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Inspector</th>
                              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contractor</th>
                              <th className="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                          </thead>
                          <tbody className="bg-white divide-y divide-gray-200">
                            {filteredInspections.map((inspection) => {
                              const statusConfig = getStatusConfig(inspection.status);
                              const StatusIcon = statusConfig.icon;
                              
                              return (
                                <tr key={inspection.id} className="hover:bg-gray-50">
                                  <td className="px-4 py-4 whitespace-nowrap">
                                    <div className="font-medium text-gray-900">{inspection.siteName}</div>
                                    <div className="text-sm text-gray-500">{inspection.permitNumber}</div>
                                  </td>
                                  <td className="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
                                    {inspection.inspector}
                                  </td>
                                  <td className="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
                                    {new Date(inspection.inspectionDate).toLocaleDateString()}
                                  </td>
                                  <td className="px-4 py-4 whitespace-nowrap">
                                    <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusConfig.color}`}>
                                      <StatusIcon />
                                      <span className="ml-1">{statusConfig.label}</span>
                                    </span>
                                  </td>
                                  <td className="px-4 py-4 whitespace-nowrap text-sm text-gray-900">
                                    {inspection.contractor}
                                  </td>
                                  <td className="px-4 py-4 whitespace-nowrap text-sm font-medium">
                                    <button
                                      onClick={() => setSelectedInspection(inspection)}
                                      className="text-blue-600 hover:text-blue-900 mr-3"
                                      title="View Details"
                                    >
                                      <Eye />
                                    </button>
                                  </td>
                                </tr>
                              );
                            })}
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </>
                ) : (
                  // Contract Management Tab
                  <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    {contractPerformance.map(contract => {
                      const statusConfig = getContractStatusConfig(contract.contractStatus);
                      
                      return (
                        <div key={contract.id} className={`bg-white rounded-lg shadow-sm border-2 p-4 ${statusConfig.color}`}>
                          <div className="flex justify-between items-start mb-3">
                            <h3 className="font-semibold text-gray-900 truncate">{contract.contractor}</h3>
                            <span className={`px-2 py-1 rounded-full text-xs font-medium ${statusConfig.color}`}>
                              {statusConfig.label}
                            </span>
                          </div>
                          
                          <div className="space-y-2 text-sm">
                            <div className="flex justify-between">
                              <span className="text-gray-600">Expires:</span>
                              <span className="font-medium">
                                {new Date(contract.expirationDate).toLocaleDateString()}
                              </span>
                            </div>
                            
                            <div className="flex justify-between">
                              <span className="text-gray-600">This Month:</span>
                              <span className="font-medium">{contract.thisMonthCompleted}/{contract.monthlyQuota}</span>
                            </div>
                            
                            <div className="w-full bg-gray-200 rounded-full h-2">
                              <div 
                                className={`h-2 rounded-full ${
                                  contract.monthlyProgress >= 100 ? 'bg-green-500' :
                                  contract.monthlyProgress >= 75 ? 'bg-yellow-500' : 'bg-blue-500'
                                }`}
                                style={{ width: `${Math.min(contract.monthlyProgress, 100)}%` }}
                              />
                            </div>
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </div>

              {/* Inspection Details Modal */}
              {selectedInspection && (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
                  <div className="bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                    <div className="flex justify-between items-start mb-4">
                      <div>
                        <h3 className="text-xl font-semibold">{selectedInspection.siteName}</h3>
                        <p className="text-gray-600">{selectedInspection.address}</p>
                      </div>
                      <button
                        onClick={() => setSelectedInspection(null)}
                        className="text-gray-500 hover:text-gray-700"
                      >
                        ×
                      </button>
                    </div>
                    
                    <div className="grid grid-cols-2 gap-4 mb-4">
                      <div>
                        <label className="text-sm font-medium text-gray-500">Inspector</label>
                        <p className="text-gray-900">{selectedInspection.inspector}</p>
                      </div>
                      <div>
                        <label className="text-sm font-medium text-gray-500">Contractor</label>
                        <p className="text-gray-900">{selectedInspection.contractor}</p>
                      </div>
                    </div>
                    
                    <div className="mb-4">
                      <label className="text-sm font-medium text-gray-500">Findings</label>
                      <p className="text-gray-900 bg-gray-50 p-3 rounded">{selectedInspection.findings}</p>
                    </div>
                    
                    <button
                      onClick={() => setSelectedInspection(null)}
                      className="bg-gray-300 text-gray-700 px-4 py-2 rounded hover:bg-gray-400 transition-colors"
                    >
                      Close
                    </button>
                  </div>
                </div>
              )}
            </div>
          );
        };

        ReactDOM.render(<SWPPPInspectionHub />, document.getElementById('root'));
    </script>
</body>
</html>
